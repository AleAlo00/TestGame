{% extends "master.html" %}

{% block title %}
Details about {{ myphone.name }}
{% endblock %}

{% block content %}
<div>
  <h1>{{ myphone.name }}</h1>

  <p>ID: {{ myphone.id }}</p>
  <p>Date: {{ myphone.date }}</p>

  <ul id="characteristics-list">
    {% for key, value in myphone.characteristics.items %}
      <li>{{ key }}: {{ value }}</li>
    {% endfor %}
  </ul>

  <form action="{% url 'add_specific' phone_id=myphone.id %}" method="POST">
    {% csrf_token %}
    <label for="characteristic">Choose a characteristic:</label>
    <select name="characteristic" id="characteristic">
      <option value="">Select a characteristic</option>
      {% for key in default_characteristics.keys %}
        {% if key not in myphone.characteristics %}
          <option value="{{ key }}">{{ key }}</option>
        {% endif %}
      {% endfor %}
    </select>

    <label for="specific">Choose a specific:</label>
    <select name="specific" id="specific">
      <option value="">Select a specific</option>
    </select>

    <button type="submit">Add Specific</button>
  </form>

  <p><a href="/phone">Back to Phone</a></p>
</div>

<script>
  // Crea un oggetto che mappa le caratteristiche alle loro specifiche
  const characteristics = {{ default_characteristics|safe }};
  
  const characteristicSelect = document.getElementById("characteristic");
  const specificSelect = document.getElementById("specific");

  characteristicSelect.addEventListener("change", function() {
    const selectedCharacteristic = characteristicSelect.value;
    
    // Pulisce la lista delle specifiche
    specificSelect.innerHTML = '<option value="">Select a specific</option>';

    if (selectedCharacteristic && characteristics[selectedCharacteristic]) {
      // Aggiungi le opzioni corrispondenti alle specifiche
      const specifics = characteristics[selectedCharacteristic];
      specifics.forEach(function(spec) {
        const option = document.createElement("option");
        option.value = spec;
        option.textContent = spec;
        specificSelect.appendChild(option);
      });
    }
  });
</script>
{% endblock %}
